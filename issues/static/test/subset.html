<!DOCTYPE html>
<html>
<head>
	<title>Test Backbone.Subset</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="/static/css/bootstrap.css">
	<link rel="stylesheet" href="/static/css/issues.css">
	<script src="/static/js/jquery-2.0.3.js"></script>
	<script src="/static/js/underscore.js"></script>
	<script src="/static/js/backbone.js"></script>
</head>
<body>
	<!-- Init app -->
	<script src="/static/test/subset.js"></script>
	<script>
		var Issue = Backbone.Model.extend({});

		var issues = [
			new Issue({title: 'Issue 1', completed: false}),
			new Issue({title: 'Issue 2', completed: false}),
			new Issue({title: 'Issue 3', completed: false})
		];

		var all = new Backbone.Collection([], {
			model: Issue,
			url: '/api/dummy'
		});

		var todo = new Backbone.Subset(issues, {
			superset: all,
			url: '/api/dummy/todo',
			filter: function(issue) {
				return !issue.get('completed');
			}
		});

		console.assert(todo.models.length == 3);

		all.create({
			title: 'New issue 4',
			completed: true
		});

		console.assert(todo.models.length == 3);

		all.create({
			title: 'New issue 5',
			completed: false
		});

		console.assert(todo.models.length == 4);

		issues[0].set({completed: true});

		console.assert(todo.models.length == 3);

	</script>
</body>
</html>